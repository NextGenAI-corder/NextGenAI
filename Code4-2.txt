package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "net/http"
    "os"
)

type Message struct {
    Type string `json:"type"`
    Text string `json:"text"`
}

var accessToken = os.Getenv("LINE_ACCESS_TOKEN")

type Reply struct {
    ReplyToken string   `json:"replyToken"`
    Messages   []Message `json:"messages"`
}

func sendReply(replyToken, message string) {
    reply := Reply{
        ReplyToken: replyToken,
        Messages:   []Message{{Type: "text", Text: message}},
    }

    payload, _ := json.Marshal(reply)
    req, _ := http.NewRequest("POST", "https://api.line.me/v2/Bot/message/reply", bytes.NewBuffer(payload))
    req.Header.Set("Content-Type", "application/json")
    req.Header.Set("Authorization", "Bearer " + accessToken)

    client := &http.Client{}
    res, err := client.Do(req)
    if err != nil {
        fmt.Println("送信エラー:", err)
        return
    }
    defer res.Body.Close()
    fmt.Println("レスポンスステータス:", res.Status)
}